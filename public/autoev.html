<!DOCTYPE html>
<html>
<head>
	<title>Autoevaluaci贸n</title>
	<meta charset="UTF-8">
	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
		<script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/FileSaver.js" type="text/javascript"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
	
		<script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"></script>
		
		<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-auth.js"></script>
		<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-database.js"></script>
		<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-messaging.js"></script>

		<!-- Leave out Storage -->
		<!-- <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-storage.js"></script> -->
		
		<script>
		  // Initialize Firebase
		  var config = {
		    apiKey: "AIzaSyBM1wW2a1Ot1zsHkBSv7-dh2y20UZ_dFKI",
		    authDomain: "evaluacion-personal.firebaseapp.com",
		    databaseURL: "https://evaluacion-personal.firebaseio.com",
		    projectId: "evaluacion-personal",
		    storageBucket: "evaluacion-personal.appspot.com",
		    messagingSenderId: "67231726295"
		  };
		  firebase.initializeApp(config);
		  
		   var database = firebase.database();
		</script>
	
	<script type="text/javascript" language="javascript">
        function OpenWindow2() {
				var user = firebase.auth().currentUser;
				console.log(user);
                window.open('llegada.html');
        }
	</script>
	
	<script>
		function writeNewAutoev() {
			   var user = firebase.auth().currentUser;
			  console.log(user.email);
			  var correo = user.email;
			  var usuario = correo.split("@")[0];
			  var gestion_personas= $("#gestion_personas").val();
			  var pyr = $("#pyr").val();
			  var fcyt = $("#fcyt").val();
			  var com = $("#com").val();
			  var serv = $("#serv").val();
			   var total = (0.15 * parseInt($("#gestion_personas").val())) + (0.3 * parseInt($("#pyr").val())) + (0.3 * parseInt($("#fcyt").val())) + (0.15 * parseInt($("#com").val())) + (0.1 * parseInt($("#serv").val()));
			  var autoEvData = {
			    gestion_personas: gestion_personas,
			    pyr: pyr,
				fcyt: fcyt,
				com: com,
			    serv: serv,
			    fecha: 0,
				total: total
			  };

			  var newEvalKey = firebase.database().ref().child(usuario + '/propia').push().key;

			  var updates = {};
			  updates[usuario + "/propia_" + usuario] = autoEvData;

			  return firebase.database().ref().update(updates);
			}
			
	</script>
	
</head>
<body>

<form id="empleado" action="javascript:writeNewAutoev();alert('Evaluaci贸n enviada correctamente')" method="post">
  <input type="number" id="gestion_personas" name="gestion_personas" value="gestion_personas" min="1" max="5" step="1"> Gesti贸n personas<br>
  <input type="number" id="pyr" name="pyr" value="pyr" min="1" max="5" step="1"> Proactividad y Responsabilidad <br>
  <input type="number" id="fcyt" name="fcyt" value="fcyt" min="1" max="5" step="1"> Flexibilidad, Creatividad y Trabajo en Equipo <br>
  <input type="number" id="com" name="com" value="com" min="1" max="5" step="1"> Comunicaci贸n<br>
  <input type="number" id="serv" name="serv" value="serv" min="1" max="5" step="1"> Servicio al Cliente <br>
  
  <button type="submit" value="Submit"> Submit </button>
  
</form>

</body>
</html>
